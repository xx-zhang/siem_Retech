
## 一、前言

开源软件具有开放、共享、自由等特性，在软件开发中扮演着越来越重要的角色，也是软件供应链的重要组成部分。据Gartner调查显示，99%的组织在其
IT系统中使用了开源软件。而来自Sonatype公司的一项调查则显示，在参与调查的3000家企业中，每年每家企业平均下载 5000个开源软件。

然而，开源软件中存在大量的安全隐患，企业在享受开源软件带来的便利的同时，也在承担着巨大的安全风险。近年来，开源软件频繁爆出高危漏洞，例如jackson、sh
iro、Struts2,、OpenSSL等。这些组件很多都应用于信息系统的底层，并且应用范围非常广泛，因此漏洞带来的安全危害非同一般。

根据国外安全机构的调研报告显示，企业应用代码超过80%来自第三方资源库或第三方组件，97%的java程序至少存在1个已知安全漏洞，而由第三方代码缺陷导致的信
息泄露漏洞占比高达72%。

为了解决上述问题，软件成分分析（SCA）应运而生。

## 二、SCA

SCA，Software Composition Analysis，软件成分分析产品通常在开发过程中对应用程序进行分析，以检测开源软件组件是否带有已知的漏洞
，例如具有可用安全补丁程序的过期库，以及需要相应授权许可（法律风险）的商业软件或第三方产品。

说直白点，就是应用中使用的开源组件是否存在重大风险漏洞？是否存在许可证风险？

### 2.1、解决什么问题

* **第三方组件的已知漏洞。** 主要针对第三方组件的开源特性，挖掘其代码中已存在安全漏洞，攻击者利用这些漏洞，对生产应用进行攻击和破坏，造成损失。

* **第三方组件的软件许可问题。** 这方面的风险性偏低，主要是第三方组件的licence。现有的licence许可在使用上几乎没有限制，但同时也存在一些限制性较强的许可证，例如**GPL**，始终开放源代码。

* **第三方组件的篡改问题。** 主要针对非正规渠道下载三方组件，该组件可能被其他开发者恶意篡改，存在风险漏洞，若开发过程中未仔细检查确认，则会给生产应用造成极大的风险隐患。

### 2.2、如何搭建SCA

SCA：软件成分分析平台，以应用中依赖的开源组件为检测主体，结合外部三方漏洞库对组件进行风险排查。同时围绕SDL的生命周期，从应用的开发前 - 开发中 -
上线前 - 上线后进行风险的感知、识别和处理；



![](/uploads/secdos11077/images/m_df60da5519ef6ce2f74599a404d68807_r.png)

![](/uploads/secdos11077/images/m_db361f64f7d05c5e6cbbbabddee57b24_r.png)

### 2.3、构建风险组件库

通常会借助于外部三方的漏洞库平台，借助他们公布的组件漏洞信息，构建企业内部自身的风险组件库。通常风险组件库会开放给到业务侧的应用研发，因此需要在风险组件中，
描述其潜在的风险信息、以及对应的修复建议。

比较常用的漏洞平台，包括：

名称URL

snyk

[https://security.snyk.io/](https://link.zhihu.com/?target=https%3A//security.
snyk.io/)

cve

[https://cve.mitre.org/index.html](https://link.zhihu.com/?target=https%3A//cv
e.mitre.org/index.html)

……

### 2.4、定期安全巡检三方组件

这是一个**重监控、轻管控**的过程。通过定期对开发、测试、生产环境上的应用进行安全巡检，读取其依赖的三方组件清单，分析依赖组件的名称、版本，将组件信息与上
述的风险组件库进行比较匹配，整理出存在风险漏洞的组件清单。

其底层的主要检测方式是，分析组件的group_id、artifact_id、版本号等，将该信息与风险组件库中的组件进行一一匹配，确定该组件是否存在漏洞，以及
该漏洞对应的风险等级，来确定组件是否需要修复。

这种做法简单有效，能够解决大部分问题，适用于场景广泛。

> 实际环节中，会存在一些例外。例如：某组件被应用关联，但在实际代码环节并未被使用。而该组件的确被爆出高危风险漏洞，此时通过安全巡检得出该应用需要修复。该场
景无疑会降低业务研发与安全之间的信任感……

### 2.5、发布时对组件强管控

这是一个终极大招。风险应用发布到生产，其潜在的风险对于企业而言，无疑是巨大的。而定期安全巡检，更多的是提醒和督促研发同学进行修复，对于修复效果的回收是不及时
的。

因此在应用发布节点，增加风险组件的卡点功能，即应用发布时，将其依赖的三方组件清单，同风险组件库再次进行比较匹配，针对高危风险组件，则拦截应用发布，并引导研发
同学修复组件后再次进行发布。

> 部分场景下，针对紧急发布的应用，若其关联的组件被定性为风险组件，则发布拦截，此时会打断并延长其发布时间，体感上不友好。这就要求将组件的风险识别更提前……

### 2.6、构建安全运营闭环

对于已知的风险组件，需要借助漏洞管理、工单运营等基础能力，将风险转化为漏洞 or
事件，进入安全运营流程。在运营流程中，更多要关注漏洞本身的修复时效问题和修复状态跟踪，尤其是线上的风险组件，晚一天都可能造成极大的资产损失。

漏洞平台、事件平台，后期会放入安全运营平台进行讲述。

### 2.7、与AST工具集成

AST工具集成SCA的能力一般也都是商业工具才有的，与AST工具集成有得天独厚的优势。做开发安全AST就是绕不过去的坎，所以在做AST测试的时候，顺带着就可
以把SCA做了，省时又省力，但是缺点是与AST工具集成的SCA只能随项目走，不具备从源头治理的能力，简单来讲就是专业度不够。

目前针对应用安全检测的工具可以分为三类，SAST、IAST和DAST。

## 三、从源头上把控风险

上述讲的更多是在风险已经发生的情况下，快速感知到风险，将风险转化为漏洞 or 事件进行治理和消化。

但是风险治理的最高境界，是没有风险发生，就像武学的最高境界，无招胜有招。

### 3.1、加强安全教育

建立安全开发流程SOP，尤其对风险组件的引用制定相关流程，明确组件的获取渠道、使用方式，并针对使用不合规组件的行为建立处罚机制。

### 3.1、构建安全组件库

这里主要是针对第三方组件做一个安全检测，检测通过的组件会进入安全组件库进行存储，应用在构建过程中需要依赖的三方组件需要从该安全组件库中进行获取。

一般是与中间件团队进行联合构建，对中间件而言，他们维护的是公司内部统一的开源组件库，做到组件标准、统一管理；对于安全团队而言，单点对接，维护的成本降低。

## 四、SCA 2.0猜想

软件供应链攻击时间，近几年呈现上升趋势，风险组件的使用，无疑增加了被攻击的可能性。SCA的建设是对于攻击者的正面抵抗和自身安全能力建设的证明。

SCA，完成了组件的风险识别和风险管控；但是风险组件仍然存在，仍然存在一定的可能性被企业引用，对企业 or
社会都是风险隐患，尤其是对于自身安全能力不完善的小微企业而言。

SCA2.0的发展方向，在我看来，可能会有两个方向：

方向1：产品服务化，开放自身SCA产品给到小微企业，帮助其建设风险组件治理能力；

方向2：能力标准化，建立行业标注风险组件检测能力，允许企业上传组件文件进行风险检测；

也许在不久的未来，整个行业在风险组件上面会制定统一的标准，就像超市中的面包，包装上都会表示使用了哪些原料配料，遵循哪些标准，在我们看来习以为常的事情确保了超
市食品供应链和每一位顾客的安全。