# 安全运营概述

## 背景 

```
1、终端采集的开发工作要转给研发他们，但是需求设计和规则开发还是在咱们这。
2、【重点】另外需要对产线所有产品进行渗透测试，包括页面，apt接口等方面。
3、【重点】产线今后的一个非常重要的工作就是安全运营能力的输出，简单理解就是咱们部门把产线产品用熟悉了，告诉技术支持们如何更好的开展运营工作，在安全运营工作中还有第三方的工具、脚本、方法等可以提升安全运营的效率和效果。
4、【重点】产线产品的分析规则的设计和开发
5、CLI开发，其他和2 3相关的工具和脚本的开发
6、【重点】需要能够为产线整体运营工作进行推广宣传工作，需要方案编写和能出去讲的专业人才
```

## Step1 发现问题（解决的背景）
发现安全威胁的存在，是什么类型的网络攻击，造成了什么样的影响。
根据事件进行分类，归结事件到

```
数据安全 数据传输，合规检查 
网络安全 netflow/c2/rat/
主机安全 权限提升、权限维持、命令执行、达成目标
Web安全 数据目标、达成目标、远程与控制
```

包含的元素信息
事件类型、事件概要、造成事件的原因、事件影响、威胁等级、解决方法、关联的重大活动、TTP、漏洞


### 问题核心的沟通来源 (用户层面产品运营支撑)
> 客户、安服、运营。
>
### 实施步骤
- 1. 充分熟悉公司的产品
- 2. 加强沟通和相关培训，甚至临近现场，
- 3. 沟通后的能力迭代（反馈到产品相关的运营能力、平台自身能力）


## Step2 模型的思路（分析框架）
方法论的核心 （驱动运营方案落地核心方法）
行业框架 `Att&ck, d3fend, CWE`

举例-数据库查询语句的过滤和基准订立 [d3fend-探测-过程分析](https://d3fend.mitre.org/technique/d3f:DatabaseQueryStringAnalysis/)

> 模型建立的条件，模型检测的方法，模型背景。从思路上这个内容分为4步，但是思路和建立的过程都是单一引导的，就是这个解决方法和数据实体。
输出的就是日志事件分析后自身传递的信息。

## Step3 数据实体 （资源）
**NOTE: 对应的模型需要对应的数据，如果没有就不足以支撑模型的产出，需要和客户沟通**
数据安全 - UEBA（User-and-Entity-Behavior-Analytics-UEBA）

**模型本身需要的数据内容、数据规范、数据源等信息。**
> STIX1 中指该威胁源在攻击时可观测到的一系列行为特征，包括流量侧和系统侧两大类，如访问特定的C&C节点、特定的扫描行为、在特定时间发送钓鱼邮件、尝试上传某类Webshell等。

```
Observed Data提供了对各种可以被观察到的对象的结构化描述，
其中包括了大部分IOC指标中所涉及的数据类型，如
Directory、Domain Name、File、IPv4 Address、IPv6 Address、MAC Address、
Email Address、Email Message、
Network Traffic(包含HTTP、ICMP、TCP等多个扩展，表示网络请求、网络访问情况等)、
Process、Software、User Account、URL、Registry、Certificate
```

> 观察的数据包括关于“观察到的实例”和“观察到的模式”：
观察到的实例表示发生在网络领域中的实际具体的观察结果，
是具体和明确的。观察到的模式表示在未来可能发生的或可能已经发生并且存在于观察到的实例主体中的潜在观察条件。

### 当前成果

**直接产出**
支撑态势的模型二十几个。
支撑ITA+BD_ITA的模型十几个。

**简介产出**
> 收集 att&ck / d3fend 已经收录的威胁检测类型，进行威胁事件的复现，测试当前数据源和检测方法是否足够。
> 已经对 linux-att&ck 完成了68个战术的建模，对 windows 完成了关于终端安全下的 51/171 个事件建模。

## Step4 落地的规则实体（落地）
建立为平台能用的，串联下的规则。


